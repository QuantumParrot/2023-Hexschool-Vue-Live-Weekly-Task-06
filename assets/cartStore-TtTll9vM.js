import{a as s,S as d,m as l}from"./messageStore-WDthNYp3.js";import{j as h,a as c}from"./index-eoB7v4AR.js";import{l as n}from"./loadingStore-yEdzsKbJ.js";var m={VITE_APP_SITE:"https://ec-course-api.hexschool.io/v2",VITE_APP_PATH:"ataraxia",BASE_URL:"/2023-Hexschool-Vue-Live-Weekly-Task-06",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_SITE:o,VITE_APP_PATH:i}=m,g=h("cartStore",{state:()=>({carts:[],total:0}),actions:{...c(n,["createLoader","removeLoader"]),...c(l,["toastAlert","errorHandle"]),getCartsData(){this.createLoader("getCartsData"),s.get(`${o}/api/${i}/cart`).then(a=>{const{carts:t,total:r}=a.data.data;this.carts=t,this.total=r}).catch(a=>this.errorHandle(a,"error")).finally(()=>this.removeLoader("getCartsData"))},addToCart(a,t=1){const r=this.carts.find(e=>e.product.id===a);if(r){let e=r.qty;this.changeCartQty(r,e+=t)}else this.createLoader("addToCart"),s.post(`${o}/api/${i}/cart`,{data:{product_id:a,qty:t}}).then(e=>{this.toastAlert(e.data.message,"success"),this.getCartsData()}).catch(e=>this.errorHandle(e)).finally(()=>this.removeLoader("addToCart"))},changeCartQty(a,t){this.createLoader("changeCartQty");const r=t*1;s.put(`${o}/api/${i}/cart/${a.id}`,{data:{product_id:a.product.id,qty:r}}).then(e=>{this.toastAlert(e.data.message,"success"),this.getCartsData()}).catch(e=>this.errorHandle(e)).finally(()=>this.removeLoader("changeCartQty"))},deleteCartItem(a){this.createLoader("deleteCartItem"),s.delete(`${o}/api/${i}/cart/${a}`).then(t=>{this.toastAlert(t.data.message,"success"),this.getCartsData()}).catch(t=>this.errorHandle(t)).finally(()=>this.removeLoader("deleteCartItem"))},deletAllCart(){d.fire({title:"確定清空購物車的商品嗎？",showCancelButton:!0,confirmButtonColor:"#dc3545",confirmButtonText:"確定",cancelButtonText:"取消"}).then(a=>{a.isConfirmed&&(this.createLoader("deleteAllCart"),s.delete(`${o}/api/${i}/carts`).then(t=>{this.toastAlert(t.data.message,"success"),this.getCartsData()}).catch(t=>this.errorHandle(t)).finally(()=>this.removeLoader("deleteAllCart")))})}}});export{g as c};
