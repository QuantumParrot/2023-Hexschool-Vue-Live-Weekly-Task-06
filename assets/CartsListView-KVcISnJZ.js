import{i as L,a as u,m as b,_ as k,o as r,c as d,b as e,d as o,w as _,n as f,t as l,e as n,r as h,F as C,g as F,j as x,v as E,h as O}from"./index-q7ML1dqU.js";import{l as V}from"./loadingStore-TgtJ6Wx-.js";import{S as A,a as z,m as P}from"./messageStore-r8FGZWJD.js";import{c as g}from"./cartStore-F0z7_kog.js";import{d as S,c as D,l as M,s as I,v as B,F as q,a as N,E as R,z as H,r as W,e as j}from"./zh_TW-NKnUa8Ni.js";var U={VITE_APP_SITE:"https://ec-course-api.hexschool.io/v2",VITE_APP_PATH:"ataraxia",BASE_URL:"/2023-Hexschool-Vue-Live-Weekly-Task-06",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_SITE:Q,VITE_APP_PATH:G}=U,w=L("orderStore",{state:()=>({showForm:!1}),actions:{...u(V,["createLoader","removeLoader"]),...u(P,["toastAlert","errorHandle"]),...u(g,["getCartsData"]),displayForm(){this.showForm=!0},submitOrder(s,{resetForm:i}){A.fire({title:"確定送出訂單？",showCancelButton:!0,confirmButtonColor:"#dc3545",confirmButtonText:"確定",cancelButtonText:"取消"}).then(v=>{if(v.isConfirmed){this.createLoader("submitOrder");const $={user:{name:s.name,address:s.address,tel:s.tel,email:s.email},message:s.message||"無"};z.post(`${Q}/api/${G}/order`,{data:$}).then(p=>{i(),this.toastAlert(`${p.data.message}，感謝您的訂購！`,"success"),this.getCartsData()}).catch(p=>this.errorHandle(p,"error")).finally(()=>this.removeLoader("submitOrder"))}})}}});S("required",W);S("email",j);D({generateMessage:M({zh_TW:H}),validateOnInput:!0});I("zh_TW");const J={mixins:[B],components:{VForm:q,VField:N,ErrorMessage:R},computed:{...b(g,["carts"])},methods:{...u(w,["submitOrder"])}},K={class:"container py-5"},X={class:"row justify-content-center"},Y={class:"col-md-6"},Z=e("h3",{class:"mb-4"},"填寫寄送資訊",-1),ee=e("div",{class:"alert bg-secondary-subtle px-4"},[e("span",{class:"text-danger me-2"},"*"),n("為必填欄位哦！ ")],-1),se={class:"mb-3"},te=e("label",{for:"name",class:"form-label"},[e("span",{class:"text-danger fst-italic me-1"},"*"),n(" 您的大名")],-1),ae={class:"invalid-feedback"},oe={class:"mb-3"},le=e("label",{for:"email",class:"form-label"},[e("span",{class:"text-danger fst-italic me-1"},"*"),n(" 電子信箱")],-1),ne={class:"invalid-feedback"},ie={class:"mb-3"},re=e("label",{for:"tel",class:"form-label"},[e("span",{class:"text-danger fst-italic me-1"},"*"),n(" 您的手機")],-1),de={class:"invalid-feedback"},ce={class:"mb-3"},me=e("label",{for:"address",class:"form-label"},[e("span",{class:"text-danger fst-italic me-1"},"*"),n(" 寄送地址")],-1),_e={class:"invalid-feedback"},ue={class:"mb-3"},he=e("label",{for:"message",class:"form-label"},"備註與留言",-1),pe=["disabled"];function fe(s,i,v,$,p,T){const c=h("VField"),m=h("ErrorMessage"),y=h("VForm");return r(),d("div",K,[e("div",X,[e("div",Y,[Z,ee,o(y,{class:"card p-4",onSubmit:s.submitOrder},{default:_(({errors:t})=>[e("div",se,[te,o(c,{type:"text",id:"name",class:f(["form-control mb-2",{"is-invalid":t.name}]),name:"name",rules:"required"},null,8,["class"]),o(m,{name:"name"},{default:_(({message:a})=>[e("p",ae,l(s.localizeMessage(a,"name")),1)]),_:1})]),e("div",oe,[le,o(c,{type:"email",id:"email",class:f(["form-control mb-2",{"is-invalid":t.email}]),name:"email",rules:"required|email"},null,8,["class"]),o(m,{name:"email"},{default:_(({message:a})=>[e("p",ne,l(s.localizeMessage(a,"email")),1)]),_:1})]),e("div",ie,[re,o(c,{type:"tel",id:"tel",class:f(["form-control mb-2",{"is-invalid":t.tel}]),name:"tel",rules:s.tel},null,8,["class","rules"]),o(m,{name:"tel"},{default:_(({message:a})=>[e("p",de,l(s.localizeMessage(a,"tel")),1)]),_:1})]),e("div",ce,[me,o(c,{type:"text",id:"address",class:f(["form-control mb-2",{"is-invalid":t.address}]),name:"address",rules:"required"},null,8,["class"]),o(m,{name:"address"},{default:_(({message:a})=>[e("p",_e,l(s.localizeMessage(a,"address")),1)]),_:1})]),e("div",ue,[he,o(c,{id:"message",class:"form-control mb-2",rows:"5",name:"message",as:"textarea"})]),e("button",{type:"submit",class:"btn btn-secondary",disabled:!s.carts.length}," 確定送出",8,pe)]),_:1},8,["onSubmit"])])])])}const be=k(J,[["render",fe]]),ge={components:{OrderForm:be},computed:{...b(V,["isLoading"]),...b(w,["showForm"]),...b(g,["carts","total"])},methods:{...u(w,["displayForm"]),...u(g,["getCartsData","changeCartQty","deleteCartItem","deletAllCart"])},mounted(){this.getCartsData()}},ve={class:"container my-5",style:{"min-height":"100vh"}},$e=e("h2",{class:"fw-bolder mb-5"},"購物車",-1),ye={key:0,class:"alert bg-secondary-subtle"},Ce={key:1,class:"table"},we=e("thead",null,[e("tr",null,[e("th",{width:"10%"},"處理"),e("th",{width:"50%"},"商品"),e("th",{width:"15%",class:"text-end"},"單價"),e("th",{width:"15%",class:"text-end"},"數量"),e("th",{width:"10%",class:"text-end"},"小計")])],-1),Fe={class:"align-middle"},ke=["onClick"],Ve=e("i",{class:"bi bi-trash-fill me-2"},null,-1),Se=e("span",null,"刪除",-1),Te=[Ve,Se],Le=["src","alt"],xe={class:"d-inline-block align-middle"},Ee={class:"fs-5 fw-bold mb-1"},Oe={class:"fs-7 fst-italic text-muted mb-0"},Ae={class:"text-end"},ze={key:0,class:"text-muted me-1 text-decoration-line-through"},Pe={class:"input-group ps-3"},De=["value","onChange"],Me=["value"],Ie={class:"input-group-text"},Be={class:"text-end fw-bold"},qe={class:"fs-5 fw-bold"},Ne={colspan:"5",class:"py-3"},Re={class:"d-flex justify-content-between align-items-center"},He={class:"d-flex align-items-center gap-3"},We=e("i",{class:"bi bi-cart-check-fill me-2"},null,-1),je=e("span",null,"結帳",-1),Ue=[We,je];function Qe(s,i,v,$,p,T){const c=h("LoadingOverlay"),m=h("RouterLink"),y=h("OrderForm");return r(),d(C,null,[o(c,{active:s.isLoading,"onUpdate:active":i[0]||(i[0]=t=>s.isLoading=t),"z-index":1e3},null,8,["active"]),e("div",ve,[$e,s.carts.length?(r(),d("table",Ce,[we,e("tbody",Fe,[(r(!0),d(C,null,F(s.carts,t=>(r(),d("tr",{key:t.id},[e("td",null,[e("button",{type:"button",class:"btn btn-danger",onClick:a=>s.deleteCartItem(t.id)},Te,8,ke)]),e("td",null,[e("img",{class:"cart-img me-4",src:t.product.imageUrl,alt:t.product.title},null,8,Le),e("div",xe,[e("p",Ee,l(t.product.title),1),e("p",Oe,l(t.product.content),1)])]),e("td",Ae,[n(" NT$ "),t.product.origin_price!==t.product.price?(r(),d("span",ze,l(t.product.origin_price),1)):O("",!0),e("span",null,l(t.product.price)+" 元",1)]),e("td",null,[e("div",Pe,[e("select",{class:"form-select",value:t.qty,onChange:a=>s.changeCartQty(t,a.target.value)},[(r(!0),d(C,null,F(10*Math.ceil((t.qty+1)/10),a=>(r(),d("option",{key:a,value:a},l(a),9,Me))),128))],40,De),e("span",Ie,l(t.product.unit),1)])]),e("td",Be,"NT$ "+l(t.total)+" 元",1)]))),128))]),e("tfoot",null,[e("tr",qe,[e("td",Ne,[e("div",Re,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:i[1]||(i[1]=t=>s.confirm("確定清空購物車？",s.deletAllCart))},"清空購物車"),e("div",He,[n(" 總計：NT$ "+l(s.total)+" 元 ",1),e("button",{type:"button",class:"btn btn-secondary",onClick:i[2]||(i[2]=(...t)=>s.displayForm&&s.displayForm(...t))},Ue)])])])])])])):(r(),d("div",ye,[n(" 購物車內目前沒有商品，去"),o(m,{to:"/products"},{default:_(()=>[n("逛逛")]),_:1}),n("！ ")])),x(o(y,null,null,512),[[E,s.carts.length&&s.showForm]])])],64)}const Ze=k(ge,[["render",Qe]]);export{Ze as default};
